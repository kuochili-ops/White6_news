<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ğ“ƒ¥ ç™½å…­æ—¥å ± - æ™ºæ…§å®šä½å¯¦æ™‚ç‰ˆ</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@400;700;900&display=swap');
        :root { --paper: #dbd0bc; --ink: #2a2825; --accent: #7a0000; }
        
        body { background: var(--paper); margin: 0; font-family: 'Noto Serif TC', serif; color: var(--ink); display: flex; justify-content: center; overflow-x: hidden; }
        
        /* å ±ç´™ä¸»é«” */
        #newspaper-view {
            width: 100%; max-width: 450px; padding: 20px; box-sizing: border-box;
            background-image: url('https://www.transparenttextures.com/patterns/pinstriped-suit.png');
            position: relative; box-shadow: inset 0 0 100px rgba(0,0,0,0.05);
        }
        #newspaper-view::before {
            content: ""; position: absolute; top: 0; left: 50%; width: 1px; height: 100%;
            background: linear-gradient(to right, transparent, rgba(0,0,0,0.1), transparent);
        }

        header { border-top: 5px solid var(--ink); border-bottom: 2px solid var(--ink); margin-bottom: 15px; text-align: center; padding: 5px 0; }
        .newspaper-title { font-size: 2.8rem; font-weight: 900; letter-spacing: 6px; margin: 5px 0; }
        .date-line { display: flex; justify-content: space-between; font-size: 0.7rem; font-weight: 900; border-bottom: 1px solid var(--ink); padding-bottom: 2px; }

        .layout-grid { display: flex; gap: 0; min-height: 500px; border-bottom: 2px solid var(--ink); padding-bottom: 20px; }
        .left-col { width: 62%; display: flex; flex-direction: column; gap: 12px; padding-right: 12px; border-right: 1.5px solid var(--ink); }
        .right-col { width: 38%; display: flex; flex-direction: column; gap: 10px; padding-left: 12px; }

        .item-tag { background: var(--ink); color: var(--paper); padding: 2px 8px; font-size: 0.7rem; font-weight: 900; display: inline-block; margin-bottom: 5px; }
        .item-body { font-size: 0.9rem; line-height: 1.6; text-align: justify; }

        .weather-section { border: 1px solid var(--ink); padding: 8px; background: rgba(255,255,255,0.2); margin: 5px 0; }
        .weather-section h4 { font-size: 0.7rem; margin: 0 0 5px 0; color: var(--accent); text-align: center; border-bottom: 1px solid var(--ink); }
        .weather-flex { display: flex; flex-wrap: wrap; gap: 3px; font-size: 0.6rem; }
        .weather-chip { flex: 1 1 45%; display: flex; justify-content: space-between; border-bottom: 0.5px solid rgba(0,0,0,0.1); }

        .photo-box { width: 100%; height: 120px; border: 1px solid var(--ink); overflow: hidden; position: relative; background: #fff; }
        .photo-img { width: 100%; height: 100%; object-fit: cover; filter: sepia(30%); }
        .greet-text { font-size: 1.5rem; font-weight: 900; color: var(--accent); text-align: center; border-top: 1px solid var(--ink); border-bottom: 1px solid var(--ink); padding: 5px 0; margin: 5px 0; }
        .quote-box { font-size: 0.75rem; font-weight: 700; line-height: 1.5; padding: 8px; border: 1px dashed var(--ink); }

        .local-weather-card { border: 1px solid var(--ink); margin-top: auto; background: #fdfaf5; }
        .local-weather-card h5 { font-size: 0.6rem; margin: 0; text-align: center; background: var(--ink); color: var(--paper); padding: 2px 0; }
        .local-main { font-size: 1rem; font-weight: 900; text-align: center; padding: 3px 0; border-bottom: 1px double var(--ink); }
        .local-info { font-size: 0.55rem; padding: 4px; }
        .local-info div { display: flex; justify-content: space-between; margin-bottom: 1px; }

        .footer { margin-top: 15px; border: 4px double var(--ink); padding: 10px; text-align: center; font-size: 0.8rem; font-weight: bold; }
        
        /* éš±è—åŠ è¼‰ä¸­ */
        #loading-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--paper); display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 100; }
    </style>
</head>
<body>

    <div id="loading-overlay">
        <h2 style="color:var(--ink)">ğ“ƒ¥ ç™½å…­æ—¥å ±</h2>
        <p>æ­£åœ¨æ ¹æ“šæ‚¨çš„å®šä½æ’ç‰ˆä»Šæ—¥å ±ç´™...</p>
    </div>

    <div id="newspaper-view">
        <header>
            <div class="date-line">
                <span>æ­²æ¬¡ ä¹™å·³å¹´ åä¸€æœˆåä¹</span>
                <span id="current-date">2026å¹´1æœˆ7æ—¥</span>
            </div>
            <h1 class="newspaper-title">ğ“ƒ¥ ç™½å…­æ—¥å ±</h1>
        </header>

        <div class="layout-grid">
            <div class="left-col">
                <div class="news-item">
                    <div class="item-tag">åœ¨åœ°æ°£è±¡ç‰¹å ±</div>
                    <div class="item-body" id="dynamic-news">æ­£åœ¨åµæ¸¬æ‚¨çš„ä½ç½®ä»¥ç²å–ç•¶åœ°æ°£è±¡å±€ç¨¿ä»¶...</div>
                </div>

                <div class="weather-section">
                    <h4>ã€å„ç¸£å¸‚ç²¾å ±ã€‘</h4>
                    <div class="weather-flex" id="city-list">
                        </div>
                </div>

                <div class="news-item">
                    <div class="item-tag">å³æ™‚ç„¦é»</div>
                    <div class="item-body">ã€ä»Šæ—¥é ­æ¢ã€‘å…¨å°æ°£å€™è§€æ¸¬ç«™æ•¸æ“šæ›´æ–°ï¼ŒåŒ—å°ç£å—å†·æ°£åœ˜å½±éŸ¿æŒçºŒä½æº«ï¼Œè«‹æ°‘çœ¾æ³¨æ„ä¿æš–ã€‚</div>
                </div>
            </div>

            <div class="right-col">
                <div class="photo-box">
                    <img src="https://via.placeholder.com/150x120/dbd0bc/2a2825?text=Daily+Photo" class="photo-img">
                </div>
                <div class="greet-text">æ—©å®‰Â·å¹³å®‰</div>
                <div class="quote-box" id="daily-quote">ã€Œå¿ƒç¾ï¼Œçœ‹ä»€éº¼éƒ½é †çœ¼ã€‚ã€</div>
                
                <div class="local-weather-card">
                    <h5>æœ¬å ±ç‰¹ç¨¿ï¼šå³æ™‚å®šä½</h5>
                    <div class="local-main" id="local-temp">å®šä½ä¸­...</div>
                    <div class="local-info">
                        <div><span>ä»Šæ—¥å¤©å€™</span><b id="w-cond">åµæ¸¬ä¸­</b></div>
                        <div><span>ç›¸å°æ¿•åº¦</span><b id="w-hum">--%</b></div>
                        <div><span>ç©ºæ°£å“è³ª</span><b id="w-aqi">åµæ¸¬ä¸­</b></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="footer">
            å»£ å‘Š æ‹› ç§Ÿ â€§ æ•ˆ æœ å® å¤§<br>
            <span style="font-size:0.6rem">æœ¬å ±å…§å®¹æ ¹æ“šè®€è€…å®šä½å¯¦æ™‚ç”Ÿæˆ</span>
        </div>
    </div>

    <script>
        const API_KEY = "Dacfd5f7b7e6c05162ac1340b88b6cc0";

        async function fetchSmartWeather() {
            // 1. å–å¾—ä½¿ç”¨è€…åœ°ç†ä½ç½®
            navigator.geolocation.getCurrentPosition(async (position) => {
                const lat = position.coords.latitude;
                const lon = position.coords.longitude;

                try {
                    // 2. æ ¹æ“šç¶“ç·¯åº¦æŠ“å–ç•¶åœ°å¤©æ°£
                    const res = await fetch(`https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&appid=${API_KEY}&units=metric&lang=zh_tw`);
                    const data = await res.json();
                    const cityName = data.name;
                    const temp = Math.round(data.main.temp);

                    // 3. æ›´æ–° UI
                    document.getElementById('local-temp').innerText = `${cityName} ${temp}Â°C`;
                    document.getElementById('w-cond').innerText = data.weather[0].description;
                    document.getElementById('w-hum').innerText = `${data.main.humidity}%`;
                    document.getElementById('w-aqi').innerText = "å„ªè‰¯";

                    // 4. æ°£è±¡æ–°èç¨¿è¯å‹•ï¼šæ ¹æ“šåŸå¸‚åç¨±æ”¹è®Šå…§å®¹
                    document.getElementById('dynamic-news').innerText = `ã€${cityName}ç‰¹å ±ã€‘æœ¬å ±å®šä½åµæ¸¬é¡¯ç¤ºæ‚¨ç›®å‰ä½æ–¼${cityName}ã€‚å—ä»Šæ—¥æ°£å£“å½±éŸ¿ï¼Œç•¶åœ°æ°£æº«ç´„ç‚º${temp}åº¦ï¼Œ${data.weather[0].description}ã€‚è«‹ç•¶åœ°å¸‚æ°‘æ³¨æ„æ·»åŠ è¡£ç‰©ï¼Œç¶­æŒè‰¯å¥½å¥åº·ç‹€æ³ã€‚`;

                    // 5. ç”Ÿæˆå„ç¸£å¸‚åˆ—è¡¨
                    const cities = [
                        {n:"å°åŒ—", i:"â˜"}, {n:"æ–°åŒ—", i:"â˜"}, {n:"åŸºéš†", i:"â˜‚"},
                        {n:"æ¡ƒåœ’", i:"â˜"}, {n:"å°ä¸­", i:"â˜€"}, {n:"å°å—", i:"â˜€"},
                        {n:"é«˜é›„", i:"â˜€"}, {n:"å®œè˜­", i:"â˜‚"}, {n:"èŠ±è“®", i:"â˜"}
                    ];
                    document.getElementById('city-list').innerHTML = cities.map(c => 
                        `<div class="weather-chip"><span>${c.i}${c.n}</span> <b>11-16</b></div>`
                    ).join('');

                    // é—œé–‰åŠ è¼‰ç•«é¢
                    document.getElementById('loading-overlay').style.display = 'none';

                } catch (e) {
                    fallback();
                }
            }, () => {
                fallback(); // è‹¥ä½¿ç”¨è€…æ‹’çµ•å®šä½
            });
        }

        function fallback() {
            document.getElementById('dynamic-news').innerText = "ã€æœ¬å ±ç‰¹å ±ã€‘å®šä½æœå‹™æœªé–‹å•Ÿã€‚ä»Šæ—¥å…¨å°å—å¼·çƒˆå†·æ°£åœ˜å½±éŸ¿ï¼ŒåŒ—å°ç£ä½æº«ç´„ 10 åº¦ï¼Œä¸­å—éƒ¨æº«å·®å¤§ï¼Œè«‹æ°‘çœ¾æ³¨æ„ä¿æš–ã€‚";
            document.getElementById('local-temp').innerText = "å°åŒ— 14Â°C";
            document.getElementById('loading-overlay').style.display = 'none';
        }

        window.onload = () => {
            fetchSmartWeather();
            // æ¯æ—¥ä¸€å¥
            const quotes = ["ã€Œå£èªªå¥½è©±ï¼Œå¿ƒæƒ³å¥½æ„ï¼Œèº«è¡Œå¥½äº‹ã€‚ã€", "ã€ŒåŸè«’åˆ¥äººï¼Œå°±æ˜¯å–„å¾…è‡ªå·±ã€‚ã€", "ã€Œå¿ƒç¾ï¼Œçœ‹ä»€éº¼éƒ½é †çœ¼ã€‚ã€"];
            document.getElementById('daily-quote').innerText = quotes[new Date().getDate() % quotes.length];
        };
    </script>
</body>
</html>
